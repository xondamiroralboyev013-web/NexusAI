name: Release APK

on:
  push:
    branches: [ main, master ]
  workflow_dispatch: {}

jobs:
  release:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Check for APK and create release
        run: |
          mkdir -p ./release
          if [ -f "platforms/android/app/build/outputs/apk/debug/app-debug.apk" ]; then
            echo "APK found!"
            cp platforms/android/app/build/outputs/apk/debug/app-debug.apk ./release/
          else
            echo "No pre-built APK - check web version available"
          fi
          ls -lah ./release/ || echo "No APK yet - build locally"

      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          files: |
            www/app.html
            www/index.html
          tag_name: v1.0.${{ github.run_number }}
          draft: false
          prerelease: false
          body: |
            # NexusAI Release v1.0.${{ github.run_number }}
            
            ## üéâ Web Version Ready!
            
            ### ‚ú® Features
            - ‚úÖ AI Chat (Groq LLaMA 3.1 8B)
            - ‚úÖ Voice Input & Output
            - ‚úÖ Application Writer
            - ‚úÖ OAuth Login
            - ‚úÖ Dark/Light Mode
            
            ### ‚ö° Pre-Configured
            - API: https://api.groq.com/openai/v1/chat/completions
            - Model: llama-3.1-8b-instant
            - Token: Embedded ‚úì
            
            ### üåê Use Online Now!
            1. Download `app.html` from this release
            2. Open in Chrome/Firefox
            3. Create account
            4. Start chatting with AI!
            
            ### üì± APK Available
            Build locally for Android:
            ```powershell
            cd c:\Users\PC\OneDrive\Desktop\NexusAI
            .\build-apk.ps1
            ```
            
            Then upload to releases or sideload on phone.
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
